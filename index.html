<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creature Universe - Incubator & Breeder</title>
    <link rel="stylesheet" href="./src/css/style.css">
</head>
<body>
    <div id="app-header" style="display: none;"> <div id="app-title">Creature Universe</div>
        <div id="model-status-header">Models: 0 / 186</div>
        <button id="hamburger-menu-button" title="Upload Models">&#9776;</button>
    </div>

    <div id="upload-modal">
        <div id="upload-modal-content">
            <button class="modal-close-button" id="close-upload-modal" title="Close">&times;</button>
            <h2>Upload Creature Models (.glb)</h2>
            <p>Select up to 186 model files. Filenames should match expected names (e.g., "Mirefin.glb", "Ancient Mirefin.glb").</p>
            <input type="file" id="model-file-input" multiple accept=".glb">
            <div id="upload-progress-bar-container">
                <div id="upload-progress-bar">0%</div>
            </div>
            <div id="file-list-preview"></div>
            <button id="process-uploaded-files" class="modal-button" style="margin-top: 15px;">Load Selected Files</button>
        </div>
    </div>

    <div id="main-menu-container">
        <h1>Creature Universe</h1>
        <button id="new-game-button" class="menu-button">New Game</button>
        <button id="load-game-button" class="menu-button">Load Game</button>

        <div id="new-game-prompt" class="menu-dialog" style="display: none;">
            <h3>Enter Your Name</h3>
            <input type="text" id="username-input" placeholder="Username (3-15 chars, a-z, 0-9, _)">
            <div id="new-game-error" class="error-message" style="display: none;"></div>
            <div class="dialog-buttons">
                <button id="start-game-final-button" class="menu-button">Start</button>
                <button id="cancel-new-game-button" class="menu-button secondary">Cancel</button>
            </div>
        </div>

        <div id="load-game-list-container" class="menu-dialog" style="display: none;">
            <h3>Select a Saved Game</h3>
            <ul id="saved-games-list">
                <li>No saved games found.</li>
            </ul>
            <div id="load-game-error" class="error-message" style="display: none;"></div>
            <div class="dialog-buttons">
                <button id="cancel-load-game-button" class="menu-button secondary">Cancel</button>
            </div>
        </div>
    </div>

    <div id="main-container" style="display: none;"> <div id="controls">
            <h3>Incubation & Evolution</h3>
            <div class="control-group">
                <label for="environmentSelect">Incubation/Evolution Environment:</label>
                <select id="environmentSelect"></select>
            </div>
            <button id="startIncubationButton">Start Incubation (New Egg)</button>
            <div id="timer">Time: Error</div>
            <div id="hybridEggMessage" style="display:none;">Hybrid Egg Ready!</div>
            <h3 style="margin-top: 20px;">Mating</h3>
            <button id="mateButton" style="margin-top: 5px;">Mate Selected Creatures</button>
            <button id="back-to-menu-button" class="menu-button secondary" style="margin-top: 30px;">Save & Back to Menu</button>
        </div>

        <div id="viewerContainer"></div>

        <div id="side-panels">
            <div id="active-creature-panel">
                <h3>Active Creature</h3>
                <div id="activeCreatureDetails">
                    <p>No creature active.</p>
                </div>
            </div>
            <div id="storage-panel">
                <h3>Creature Storage (Max 10)</h3>
                <ul id="storedCreaturesList">
                </ul>
            </div>
        </div>
    </div>
    <div id="story-terminal-panel" class="story-terminal-hidden">
        <div id="story-terminal-content">
            <p id="story-text-area"></p>
        </div>
        <div id="story-terminal-controls">
            <button id="story-back-button">Back</button>
            <button id="story-next-button">Next</button>
            <button id="story-close-button">Close</button>
        </div>
    </div>
    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.163.0/build/three.module.js",
            "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.163.0/examples/jsm/"
        }
    }
    </script>
    <script type="module" src="./src/scripts/app.js"></script>
</body>
</html>